# REQUIREMENTS — Atticus

This document defines the runtime and build requirements for Atticus.
Use it to set up development environments, run CI, and deploy production services.

---

## Core Runtime

* **Python 3.12** — Required for both development and production.
* **Operating System** — Linux or Windows. Windows users should ensure Tesseract and Ghostscript are installed if PDF OCR is needed.

---

## Python Dependencies

Dependencies are managed with `pip-tools` for deterministic builds.

* `requirements.in` — human-maintained top‑level packages.
* `requirements.txt` — fully pinned output generated by:
  ```bash
  pip-compile -U requirements.in
  ```
* Synchronize the environment with:
  ```bash
  pip-sync requirements.txt
  ```

Typical core packages include:
* `fastapi`, `uvicorn`
* `pydantic`, `python-dotenv`
* `faiss-cpu`, `numpy`, `scikit-learn`, `rapidfuzz`
* `pymupdf`, `pdfminer.six`, `pytesseract`, `Pillow`
* `pytest`, `pytest-cov`

These are already captured and pinned in `requirements.in` and `requirements.txt`.

---

## Environment Variables

All runtime configuration is supplied through `.env` (generated by `scripts/generate_env.py`).
Key variables include:

| Variable | Purpose |
|----------|--------|
| `OPENAI_API_KEY` | Access key for GPT and embeddings |
| `GEN_MODEL` | Generation model (default `gpt-4.1`) |
| `EMBED_MODEL` | Embedding model (default `text-embedding-3-large`) |
| `CONTACT_EMAIL`, `SMTP_*` | Escalation email settings |
| ENABLE_RERANKER | Toggle hybrid reranking (defaults to disabled) |
| SMTP_DRY_RUN | Log escalation attempts without sending email |

Run `python scripts/debug_env.py` to verify that environment settings are sourced and fingerprinted correctly.

---

## Development Tooling

* **Ruff** for linting and import sorting (`make lint`, `make fmt`).
* **mypy** for static type checking (`make type`).
* **pytest** for testing (`make test`), with a target of >=90% coverage.
* Optional: `pytest-xdist` for parallel test runs; if installed, Makefile will automatically add `-n auto`.

---

## Deployment

* Use Docker Compose for reproducible production deployments.
* Ensure `.env` is present and up to date before running:
  ```bash
  docker compose up --build
  ```
* The default configuration exposes the API at `http://localhost:8000` with TLS termination handled by Nginx.

---

## References

* [README.md](README.md) — overall setup and Makefile targets.
* [AGENTS.md](AGENTS.md) — agent roles and configuration.
* [SECURITY.md](SECURITY.md) — secrets handling and IAM guidance.
\r\n---\r\n\r\n## Code Review Scope

- Coverage includes style, correctness, security, and observability.
- Review third-party dependencies (FAISS, OpenAI clients, SMTP libraries) for pinning and CVEs; stub network calls when tests require isolation.
- Deliverables: annotated PR feedback, prioritized issue list, and remediation/rollback plan delivered within three business days.

## Backlog Sweep Process

- Review README, TODO, and documentation deltas every Friday AEST; triage new items into TODO.md within 24 hours.
- Close or update backlog entries once merged and log completions with date + commit in ToDo-Complete.md.
- Surface blockers here in REQUIREMENTS.md so automations can proceed without clarification loops.

## Hero Graphic Asset

- Hero image must be 1600×900 (PNG or SVG) reflecting FUJIFILM branding and the Atticus tagline.
- Store approved assets under `web/static/img/` and reference them from README.md.
- Provide light/dark variants and document licensing or attribution in README.md.
