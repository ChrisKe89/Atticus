flowchart LR
    subgraph Atticus_Main[Atticus Main (Next.js)]
        page_root[/Page: /]
        page_admin[/Page: /admin]
        page_content[/Page: /admin/content]
        api_ask[/api/ask (POST)]
        api_uncertain[/api/admin/uncertain/*]
        api_content[/api/admin/content/*]
    end

    subgraph Admin_Service[Admin Service (9000)]
        admin_review[[Review Console]]
        admin_content[[Content Manager]]
        admin_api_approve[/api/chats/:id/approve]
        admin_api_reject[/api/chats/:id/reject]
        admin_api_draft[/api/chats/:id/save-draft]
        admin_api_reingest[/api/chats/reingest]
    end

    subgraph FastAPI
        fastapi_ask[[POST /ask]]
        fastapi_ingest[[POST /ingest]]
        fastapi_admin[[Admin review endpoints]]
    end

    subgraph Storage
        db[(Postgres + pgvector)]
        indexes[(indexes/ snapshots)]
        content_tree[(content/ tree)]
        csv_exports[[content/<family>/<model>.csv]]
    end

    api_ask --> fastapi_ask
    fastapi_ask --> db
    api_uncertain --> fastapi_admin
    fastapi_admin --> db
    page_content --> api_content
    api_content --> content_tree
    admin_content --> api_content
    admin_review --> api_uncertain
    admin_api_approve --> api_uncertain
    admin_api_reject --> api_uncertain
    admin_api_draft --> api_uncertain
    admin_api_reingest --> ingest_cli[[scripts/ingest_cli.py]]
    ingest_cli --> db
    ingest_cli --> indexes
    admin_api_approve --> csv_exports
    csv_exports --> content_tree
    csv_exports --> admin_content
