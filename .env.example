############################################
# üß† CORE MODELS & RETRIEVAL CONFIGURATION
############################################

# OpenAI API key used for embeddings and generation (leave blank for CI)
OPENAI_API_KEY=

# Embedding model used for document vectorization
# Changing this requires re-ingesting all content
EMBED_MODEL=text-embedding-3-large

# Version tag for bookkeeping only; safe to update anytime
EMBEDDING_MODEL_VERSION=text-embedding-3-large@2025-01-15

# Model used for text generation (chat responses, not embeddings)
GEN_MODEL=gpt-4.1

# Versioned prompt template used by the generation client
GEN_PROMPT_VERSION=atticus-v1

# Minimum similarity/confidence threshold for retrieved chunks
CONFIDENCE_THRESHOLD=0.70

# Chunking configuration ‚Äî affects ingestion only, not retrieval math
# Adjusting these requires re-ingesting content to apply new chunk sizes
CHUNK_TARGET_TOKENS=512
CHUNK_MIN_TOKENS=256
CHUNK_OVERLAP_TOKENS=100

# Retrieval window ‚Äî maximum chunks allowed per context
MAX_CONTEXT_CHUNKS=10

# Disable reranker (0 = off, 1 = on)
# When enabled, retrieved chunks are re-ordered by semantic similarity
ENABLE_RERANKER=0

# Number of top candidates to retrieve per query before filtering
TOP_K=20

# Evaluation regression threshold used in CI eval-gate; higher = looser tolerance
EVAL_REGRESSION_THRESHOLD=3.0

# Minimum acceptable aggregate retrieval scores for CI gates
EVAL_MIN_NDCG=0.55
EVAL_MIN_MRR=0.50

# Comma-separated retrieval modes evaluated by `make eval`
EVAL_MODES=hybrid,vector

# Optional override for where feedback seed markdown scaffolds are written.
# Defaults to ./content/seed_requests when not specified.
SEED_REQUEST_DIR=


############################################
# üìÅ PATHS & STORAGE
############################################

# Root directory containing all ingested documents
CONTENT_ROOT=./content

# Directory where vector indexes and manifests are stored
# Moving this path without re-ingesting will cause lookup errors
INDICES_DIR=./indices

# Application logs ‚Äî structured JSON (info-level)
LOG_PATH=./logs/app.jsonl

# Error logs ‚Äî structured JSON (exception stack traces)
ERROR_LOG_PATH=./logs/errors.jsonl

# Path to optional glossary/dictionary JSON (used for inline definitions)
DICTIONARY_PATH=./indices/dictionary.json

# Evaluation gold-set CSV used by admin eval seed manager
GOLD_SET_PATH=./eval/gold_set.csv


############################################
# üóÑÔ∏è DATABASE / PGVECTOR
############################################

# Connection string to Postgres database containing pgvector extension
# Safe for local dev; override via secret in production
DATABASE_URL=postgresql://atticus:atticus@localhost:5433/atticus

# Optional discrete Postgres variables (used by docker-compose)
POSTGRES_DB=atticus
POSTGRES_USER=atticus
POSTGRES_PASSWORD=atticus
POSTGRES_PORT=5433

# IVFFlat index tuning ‚Äî affects recall/speed tradeoff, not embeddings
PGVECTOR_LISTS=100
PGVECTOR_PROBES=4


############################################
# ü™µ LOGGING & OBSERVABILITY
############################################

# Logging verbosity and format
# LOG_LEVEL options: DEBUG | INFO | WARNING | ERROR
LOG_LEVEL=INFO
LOG_VERBOSE=0
LOG_TRACE=0
LOG_FORMAT=json

# System timezone (for timestamps in logs)
TIMEZONE=UTC


############################################
# üö¶ RATE LIMITING
############################################

# Simple in-process rate limiter
# Example: 5 requests per 60 seconds per client IP
RATE_LIMIT_REQUESTS=5
RATE_LIMIT_WINDOW_SECONDS=60


############################################
# üîê ADMIN / REVIEWER SERVICE
############################################

# Shared token required by FastAPI admin endpoints
ADMIN_API_TOKEN=atticus-admin-token

# Admin Next.js service ‚Üí upstream API routing
ATTICUS_MAIN_BASE_URL=http://localhost:3000
ATTICUS_ADMIN_TOKEN=${ADMIN_API_TOKEN}
ATTICUS_REVIEWER_ID=admin-service
ATTICUS_REVIEWER_NAME=Admin Service
ATTICUS_REVIEWER_EMAIL=admin@example.com


############################################
# üìß NOTIFICATIONS & ESCALATION
############################################

# Contact email for automated escalation messages
CONTACT_EMAIL=atticus-escalations@agentk.fyi

# SMTP configuration (used only if escalation emails are enabled)
SMTP_HOST=email-smtp.ap-southeast-2.amazonaws.com
SMTP_PORT=587
SMTP_USER=atticus-escalations

# WARNING: Never commit real SMTP passwords to .env.example
# Replace with placeholder; rotate if this value was ever live
SMTP_PASS=Pay641-Prove-Possible-stop-Cry

# Outgoing ‚Äúfrom‚Äù address for notifications
SMTP_FROM=atticus-escalations@agentk.fyi

# Default escalation recipient(s)
SMTP_TO=c.kent89@live.com

# Dry-run mode: 1 = do not actually send emails (for testing)
SMTP_DRY_RUN=1

# Email sandbox flag (safe for dev/test)
EMAIL_SANDBOX=true

# Optional allow-list of recipient domains for real sends (comma-separated)
SMTP_ALLOW_LIST=


############################################
# üåê FRONTEND / API INTEGRATION
############################################

# Base URL for RAG service API (used by frontend and admin)
RAG_SERVICE_URL=http://localhost:8000

# Endpoint for chat interactions (usually same as RAG_SERVICE_URL)
ASK_SERVICE_URL=http://localhost:8000
